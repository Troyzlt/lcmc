<project name="LCMC" basedir="." default="main">
	<property name="src.dir"	value="../src"/>
	<property name="java.dir"	value="${src.dir}/java"/>
	<property name="test.dir"	value="${src.dir}/test"/>
	<property name="lib.dir"	value="${src.dir}/lib"/>
	<property name="reports.dir"	value="reports"/>
	<property name="build.dir"	value="../build"/>
	<property name="classes.dir"	value="${build.dir}/classes"/>
	<property name="jar.dir"	value="${build.dir}/jar"/>
	<property name="signed.dir"	value="${build.dir}/signed"/>
	<property name="buildlib.dir"	value="../build-lib"/>
	<property name="build.coverage.dir"	value="build-coverage"/>
	
	<property name="main-class"  value="lcmc.LCMC"/>
	<tstamp/>
	<property name="now" value="${DSTAMP}-${TSTAMP}" />
	
	<target name="clean">
		<delete dir="${build.dir}/classes/lcmc/"/>
		<delete dir="${build.dir}/classes/plugins/"/>
		<delete dir="${jar.dir}"/>
	</target>
	
	<target name="superclean">
		<delete dir="${jar.dir}"/>
		<delete dir="${signed.dir}"/>
		<delete dir="${build.dir}/classes/"/>
	</target>
	
	<target name="compile">
		<mkdir dir="${classes.dir}"/>
		<copy todir="${classes.dir}/images">
			<fileset dir="${java.dir}/lcmc/images"/>
		</copy>
		
		<copy todir="${classes.dir}/help-progs">
			<fileset dir="${java.dir}/lcmc/help-progs"/>
		</copy>
		<tar tarfile="${java.dir}/lcmc/lcmc-test.tar"
		     basedir="${java.dir}/lcmc/"
		     includes="lcmc-test/**"/>
		<move tofile="${classes.dir}/lcmc-test.tar"
			file="${java.dir}/lcmc/lcmc-test.tar"
			overwrite="yes"/>
		
		<copy tofile="${classes.dir}/lcmc/release.properties"
		      file="release"
		      overwrite="yes"/>
		<!-- verbose="true" -->
		<!-- <compilerarg value="-Xlint:unchecked"/> -->
		<!-- target="jsr14" for java runtime 1.4 -->
		<!-- debug="true" -->
		<!-- fork="true" -->
		<javac 
		 fork="true" 
		 nowarn="true"
		 debug="true"
		 deprecation="false"
		 memoryInitialSize="512m"
		 memoryMaximumSize="512m"
		 srcdir="${lib.dir}" destdir="${classes.dir}"
		 encoding="utf8"
		>
		  <classpath>
		   <pathelement location="${buildlib.dir}/jai_core.jar"/>
		   <pathelement location="/usr/share/java/jai_core.jar"/>
		   <pathelement location="/usr/share/java/j3dcore.jar"/>
		   <pathelement location="/usr/share/java/j3dutils.jar"/>
		   <pathelement location="/usr/share/java/vecmath.jar"/>
		  </classpath>
		  <compilerarg value="-Xmaxerrs"/> 
		  <compilerarg value="1000"/> 
		</javac>
		
		<javac 
		 fork="true" 
		 debug="true"
		 deprecation="true"
		 memoryInitialSize="512m"
		 memoryMaximumSize="512m"
		 srcdir="${java.dir}" destdir="${classes.dir}"
		 encoding="utf8"
		>
		  <compilerarg value="-g"/> 
		  <compilerarg value="-Xlint"/> 
		  <compilerarg value="-Xmaxerrs"/> 
		  <compilerarg value="1000"/> 
		</javac>
	</target>

	<target name="jar" depends="compile">
		<mkdir dir="${jar.dir}"/>
		<jar destfile="${jar.dir}/${ant.project.name}.jar"
		     excludes="plugins/ lcmc-test.tar"
		     basedir="${classes.dir}">
			<manifest>
				<attribute name="Main-Class" value="${main-class}"/>
			</manifest>
		</jar>
	</target>
</project>
